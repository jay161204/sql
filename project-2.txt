-- Create Customers Table
CREATE TABLE IF NOT EXISTS Customers (
    CustomerID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Email VARCHAR(100),
    RegistrationDate DATE
);

-- Insert 5 records into Customers
INSERT INTO Customers (CustomerID, FirstName, LastName, Email, RegistrationDate) VALUES
(1, 'John', 'Doe', 'john.doe@email.com', '2022-03-15'),
(2, 'Jane', 'Smith', 'jane.smith@email.com', '2021-11-02'),
(3, 'Robert', 'Brown', 'robert.brown@email.com', '2023-06-10'),
(4, 'Emily', 'Davis', 'emily.davis@email.com', '2020-12-25'),
(5, 'Michael', 'Wilson', 'michael.wilson@email.com', '2022-08-05');


-- Create Orders Table
CREATE TABLE IF NOT EXISTS Orders (
    OrderID INT PRIMARY KEY,
    CustomerID INT,
    OrderDate DATE,
    TotalAmount DECIMAL(10,2)
);

-- Insert 5 records into Orders
INSERT INTO Orders (OrderID, CustomerID, OrderDate, TotalAmount) VALUES
(101, 1, '2023-07-01', 150.50),
(102, 2, '2023-07-03', 200.75),
(103, 3, '2023-08-12', 320.00),
(104, 1, '2023-09-01', 99.99),
(105, 4, '2023-09-20', 450.25);


-- Create Employees Table
CREATE TABLE IF NOT EXISTS Employees (
    EmployeeID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Department VARCHAR(50),
    HireDate DATE,
    Salary DECIMAL(10,2)
);

-- Insert 5 records into Employees
INSERT INTO Employees (EmployeeID, FirstName, LastName, Department, HireDate, Salary) VALUES
(1, 'Mark', 'Johnson', 'Sales', '2020-01-15', 50000.00),
(2, 'Susan', 'Lee', 'HR', '2021-03-20', 55000.00),
(3, 'David', 'Miller', 'IT', '2022-05-10', 60000.00),
(4, 'Anna', 'Taylor', 'Finance', '2019-11-05', 70000.00),
(5, 'James', 'Anderson', 'Sales', '2023-01-25', 52000.00);


Answers:

Ans-1
SELECT *
FROM Orders o
INNER JOIN Customers c ON o.CustomerID = c.CustomerID;


Ans-2
SELECT c.CustomerID, c.FirstName, c.LastName, o.OrderID, o.TotalAmount
FROM Customers c
LEFT JOIN Orders o ON c.CustomerID = o.CustomerID;


Ans-3
SELECT o.OrderID, o.TotalAmount, c.CustomerID, c.FirstName, c.LastName
FROM Orders o
RIGHT JOIN Customers c ON o.CustomerID = c.CustomerID;


Ans-4
SELECT c.CustomerID, c.FirstName, c.LastName, o.OrderID, o.TotalAmount
FROM Customers c
LEFT JOIN Orders o ON c.CustomerID = o.CustomerID
UNION
SELECT c.CustomerID, c.FirstName, c.LastName, o.OrderID, o.TotalAmount
FROM Customers c
RIGHT JOIN Orders o ON c.CustomerID = o.CustomerID;


Asn-5
SELECT c.CustomerID, c.FirstName, c.LastName, SUM(o.TotalAmount) AS TotalSpent
FROM Customers c
JOIN Orders o ON c.CustomerID = o.CustomerID
GROUP BY c.CustomerID, c.FirstName, c.LastName
HAVING SUM(o.TotalAmount) > (SELECT AVG(TotalAmount) FROM Orders);


Ans-6
SELECT EmployeeID, FirstName, LastName, Department, Salary
FROM Employees
WHERE Salary > (SELECT AVG(Salary) FROM Employees);


Ans-7
SELECT OrderID, 
       YEAR(OrderDate) AS OrderYear, 
       MONTH(OrderDate) AS OrderMonth
FROM Orders;


Ans-8
SELECT OrderID, DATEDIFF(CURDATE(), OrderDate) AS DaysSinceOrder
FROM Orders;


Ans-9
SELECT OrderID, DATE_FORMAT(OrderDate, '%d-%b-%Y') AS FormattedDate
FROM Orders;


Ans-10
SELECT CustomerID, CONCAT(FirstName, ' ', LastName) AS FullName
FROM Customers;



Ans-11
SELECT CustomerID, REPLACE(FirstName, 'John', 'Jonathan') AS ModifiedName
FROM Customers;


Ans-12
SELECT UPPER(FirstName) AS FirstNameUpper, LOWER(LastName) AS LastNameLower
FROM Customers;


Ans-13
SELECT TRIM(Email) AS CleanEmail
FROM Customers;



Ans-14
SELECT OrderID, OrderDate, TotalAmount,
       SUM(TotalAmount) OVER (ORDER BY OrderDate) AS RunningTotal
FROM Orders;


Ans-15
SELECT OrderID, TotalAmount,
       RANK() OVER (ORDER BY TotalAmount DESC) AS OrderRank
FROM Orders;


Ans-16
SELECT OrderID, TotalAmount,
       CASE 
           WHEN TotalAmount > 1000 THEN '10% Discount'
           WHEN TotalAmount > 500 THEN '5% Discount'
           ELSE 'No Discount'
       END AS Discount
FROM Orders;


Ans-17
SELECT EmployeeID, FirstName, LastName, Salary,
       CASE
           WHEN Salary >= 70000 THEN 'High'
           WHEN Salary >= 50000 THEN 'Medium'
           ELSE 'Low'
       END AS SalaryCategory
FROM Employees;
